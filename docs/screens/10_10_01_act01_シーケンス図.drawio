<mxfile host="65bd71144e" modified="2025-01-01T00:00:00.000Z" agent="draw.io" version="22.1.16" etag="seq-10_10_01_act01" type="device">
    <diagram id="seq-10_10_01_act01" name="認証情報入力・検証・認証処理">
        <mxGraphModel dx="1200" dy="800" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1200" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>

                <mxCell id="swimlane-user" value="ユーザー" style="swimlane;fontStyle=1;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
                    <mxGeometry x="100" y="100" width="200" height="1000" as="geometry"/>
                </mxCell>
                <mxCell id="user-lifeline" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=#6c8ebf;" vertex="1" parent="swimlane-user">
                    <mxGeometry y="40" width="200" height="960" as="geometry"/>
                </mxCell>

                <mxCell id="swimlane-ui" value="ログインページ&#xa;(フロントエンド)" style="swimlane;fontStyle=1;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
                    <mxGeometry x="350" y="100" width="250" height="1000" as="geometry"/>
                </mxCell>
                <mxCell id="ui-lifeline" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=#82b366;strokeDashArray=2 2;" vertex="1" parent="swimlane-ui">
                    <mxGeometry y="40" width="250" height="960" as="geometry"/>
                </mxCell>

                <mxCell id="swimlane-router" value="ルーター" style="swimlane;fontStyle=1;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
                    <mxGeometry x="650" y="100" width="200" height="1000" as="geometry"/>
                </mxCell>
                <mxCell id="router-lifeline" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=#d6b656;strokeDashArray=2 2;" vertex="1" parent="swimlane-router">
                    <mxGeometry y="40" width="200" height="960" as="geometry"/>
                </mxCell>

                <mxCell id="swimlane-api" value="バックエンドAPI" style="swimlane;fontStyle=1;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
                    <mxGeometry x="900" y="100" width="250" height="1000" as="geometry"/>
                </mxCell>
                <mxCell id="api-lifeline" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=#d79b00;strokeDashArray=2 2;" vertex="1" parent="swimlane-api">
                    <mxGeometry y="40" width="250" height="960" as="geometry"/>
                </mxCell>

                <mxCell id="swimlane-db" value="データベース" style="swimlane;fontStyle=1;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
                    <mxGeometry x="1200" y="100" width="200" height="1000" as="geometry"/>
                </mxCell>
                <mxCell id="db-lifeline" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=#b85450;strokeDashArray=2 2;" vertex="1" parent="swimlane-db">
                    <mxGeometry y="40" width="200" height="960" as="geometry"/>
                </mxCell>

                <mxCell id="msg-input" value="メールアドレス・パスワード入力" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#666666;labelBackgroundColor=#ffffff;fontSize=11;" edge="1" parent="1" source="user-lifeline" target="ui-lifeline">
                    <mxGeometry x="0" y="0" width="50" height="50" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="activation-ui-1" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;opacity=30;" vertex="1" parent="1">
                    <mxGeometry x="360" y="180" width="230" height="100" as="geometry"/>
                </mxCell>

                <mxCell id="msg-click" value="ログインボタンクリック" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#666666;labelBackgroundColor=#ffffff;fontSize=11;" edge="1" parent="1" source="user-lifeline" target="ui-lifeline">
                    <mxGeometry x="0" y="0" width="50" height="50" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="200" y="300"/>
                            <mxPoint x="475" y="300"/>
                        </Array>
                    </mxGeometry>
                </mxCell>

                <mxCell id="note-1" value="1. 認証情報入力" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;align=left;" vertex="1" parent="1">
                    <mxGeometry x="370" y="320" width="150" height="40" as="geometry"/>
                </mxCell>

                <mxCell id="msg-validate" value="入力検証（クライアント側）" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#666666;labelBackgroundColor=#ffffff;fontSize=11;endArrow=classic;startArrow=classic;" edge="1" parent="1" source="ui-lifeline" target="ui-lifeline">
                    <mxGeometry x="0" y="0" width="50" height="50" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="475" y="400"/>
                            <mxPoint x="550" y="400"/>
                            <mxPoint x="550" y="450"/>
                            <mxPoint x="475" y="450"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="activation-ui-2" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;opacity=30;" vertex="1" parent="1">
                    <mxGeometry x="360" y="380" width="230" height="80" as="geometry"/>
                </mxCell>

                <mxCell id="branch-error" value="検証エラー" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;align=center;" vertex="1" parent="1">
                    <mxGeometry x="380" y="500" width="120" height="80" as="geometry"/>
                </mxCell>

                <mxCell id="msg-error-display" value="エラーメッセージ表示" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#b85450;labelBackgroundColor=#ffffff;fontSize=11;" edge="1" parent="1" source="ui-lifeline" target="user-lifeline">
                    <mxGeometry x="0" y="0" width="50" height="50" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="475" y="620"/>
                            <mxPoint x="200" y="620"/>
                        </Array>
                    </mxGeometry>
                </mxCell>

                <mxCell id="branch-ok" value="検証OK" style="rhombus;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;align=center;" vertex="1" parent="1">
                    <mxGeometry x="380" y="650" width="120" height="80" as="geometry"/>
                </mxCell>

                <mxCell id="note-2" value="2. 入力検証" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;align=left;" vertex="1" parent="1">
                    <mxGeometry x="370" y="580" width="150" height="40" as="geometry"/>
                </mxCell>

                <mxCell id="msg-api-login" value="POST /api/auth/login&#xa;{email, password}" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#666666;labelBackgroundColor=#ffffff;fontSize=11;" edge="1" parent="1" source="ui-lifeline" target="api-lifeline">
                    <mxGeometry x="0" y="0" width="50" height="50" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="475" y="750"/>
                            <mxPoint x="1025" y="750"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="activation-api-1" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;opacity=30;" vertex="1" parent="1">
                    <mxGeometry x="910" y="720" width="230" height="200" as="geometry"/>
                </mxCell>

                <mxCell id="note-3" value="3. 認証処理" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;align=left;" vertex="1" parent="1">
                    <mxGeometry x="920" y="730" width="150" height="40" as="geometry"/>
                </mxCell>

                <mxCell id="msg-db-query" value="ユーザー情報取得&#xa;(emailで検索)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#666666;labelBackgroundColor=#ffffff;fontSize=11;" edge="1" parent="1" source="api-lifeline" target="db-lifeline">
                    <mxGeometry x="0" y="0" width="50" height="50" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="1025" y="800"/>
                            <mxPoint x="1300" y="800"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="activation-db-1" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;opacity=30;" vertex="1" parent="1">
                    <mxGeometry x="1210" y="780" width="180" height="60" as="geometry"/>
                </mxCell>

                <mxCell id="msg-db-response" value="ユーザー情報" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#666666;strokeDashArray=5 5;labelBackgroundColor=#ffffff;fontSize=11;" edge="1" parent="1" source="db-lifeline" target="api-lifeline">
                    <mxGeometry x="0" y="0" width="50" height="50" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="1300" y="850"/>
                            <mxPoint x="1025" y="850"/>
                        </Array>
                    </mxGeometry>
                </mxCell>

                <mxCell id="branch-no-user" value="ユーザー不存在" style="rhombus;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11;align=center;" vertex="1" parent="1">
                    <mxGeometry x="920" y="880" width="120" height="80" as="geometry"/>
                </mxCell>

                <mxCell id="msg-api-error-1" value="401 Unauthorized&#xa;{success: false, message: &quot;...&quot;}" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#b85450;strokeDashArray=5 5;labelBackgroundColor=#ffffff;fontSize=11;" edge="1" parent="1" source="api-lifeline" target="ui-lifeline">
                    <mxGeometry x="0" y="0" width="50" height="50" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="1025" y="1000"/>
                            <mxPoint x="475" y="1000"/>
                        </Array>
                    </mxGeometry>
                </mxCell>

                <mxCell id="branch-user-exists" value="ユーザー存在" style="rhombus;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;align=center;" vertex="1" parent="1">
                    <mxGeometry x="920" y="1000" width="120" height="80" as="geometry"/>
                </mxCell>

                <mxCell id="msg-password-check" value="パスワード検証&#xa;(bcrypt比較)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#666666;labelBackgroundColor=#ffffff;fontSize=11;endArrow=classic;startArrow=classic;" edge="1" parent="1" source="api-lifeline" target="api-lifeline">
                    <mxGeometry x="0" y="0" width="50" height="50" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="1025" y="1100"/>
                            <mxPoint x="1100" y="1100"/>
                            <mxPoint x="1100" y="1120"/>
                            <mxPoint x="1025" y="1120"/>
                        </Array>
                    </mxGeometry>
                </mxCell>

                <mxCell id="branch-password-mismatch" value="パスワード不一致" style="rhombus;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11;align=center;" vertex="1" parent="1">
                    <mxGeometry x="920" y="1140" width="120" height="80" as="geometry"/>
                </mxCell>

                <mxCell id="msg-api-error-2" value="401 Unauthorized&#xa;{success: false, message: &quot;...&quot;}" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#b85450;strokeDashArray=5 5;labelBackgroundColor=#ffffff;fontSize=11;" edge="1" parent="1" source="api-lifeline" target="ui-lifeline">
                    <mxGeometry x="0" y="0" width="50" height="50" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="1025" y="1260"/>
                            <mxPoint x="475" y="1260"/>
                        </Array>
                    </mxGeometry>
                </mxCell>

                <mxCell id="branch-password-match" value="パスワード一致" style="rhombus;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;align=center;" vertex="1" parent="1">
                    <mxGeometry x="920" y="1280" width="120" height="80" as="geometry"/>
                </mxCell>

                <mxCell id="msg-token-gen" value="JWTトークン生成" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#666666;labelBackgroundColor=#ffffff;fontSize=11;endArrow=classic;startArrow=classic;" edge="1" parent="1" source="api-lifeline" target="api-lifeline">
                    <mxGeometry x="0" y="0" width="50" height="50" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="1025" y="1380"/>
                            <mxPoint x="1100" y="1380"/>
                            <mxPoint x="1100" y="1400"/>
                            <mxPoint x="1025" y="1400"/>
                        </Array>
                    </mxGeometry>
                </mxCell>

                <mxCell id="msg-api-success" value="200 OK&#xa;{success: true, token: &quot;...&quot;, user: {...}}" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#82b366;strokeDashArray=5 5;labelBackgroundColor=#ffffff;fontSize=11;" edge="1" parent="1" source="api-lifeline" target="ui-lifeline">
                    <mxGeometry x="0" y="0" width="50" height="50" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="1025" y="1450"/>
                            <mxPoint x="475" y="1450"/>
                        </Array>
                    </mxGeometry>
                </mxCell>

                <mxCell id="msg-save-token" value="トークンを保存&#xa;(localStorage/sessionStorage)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#666666;labelBackgroundColor=#ffffff;fontSize=11;endArrow=classic;startArrow=classic;" edge="1" parent="1" source="ui-lifeline" target="ui-lifeline">
                    <mxGeometry x="0" y="0" width="50" height="50" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="475" y="1520"/>
                            <mxPoint x="550" y="1520"/>
                            <mxPoint x="550" y="1540"/>
                            <mxPoint x="475" y="1540"/>
                        </Array>
                    </mxGeometry>
                </mxCell>

                <mxCell id="msg-redirect" value="ダッシュボードにリダイレクト&#xa;(または元のページ)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#666666;labelBackgroundColor=#ffffff;fontSize=11;" edge="1" parent="1" source="ui-lifeline" target="router-lifeline">
                    <mxGeometry x="0" y="0" width="50" height="50" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="475" y="1600"/>
                            <mxPoint x="750" y="1600"/>
                        </Array>
                    </mxGeometry>
                </mxCell>

                <mxCell id="msg-dashboard" value="ダッシュボード表示" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#666666;labelBackgroundColor=#ffffff;fontSize=11;" edge="1" parent="1" source="router-lifeline" target="user-lifeline">
                    <mxGeometry x="0" y="0" width="50" height="50" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="750" y="1680"/>
                            <mxPoint x="200" y="1680"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>

