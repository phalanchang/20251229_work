# ログイン・ログアウト機能 実装計画書

## 1. 実装対象の全体像

### 1.1 システム構成
- **フロントエンド**: React（SPA）
- **バックエンド**: Node.js（Express）
- **データベース**: MySQL
- **インフラ**: Docker Compose

### 1.2 実装する機能
1. **ログイン機能**
   - メールアドレス・パスワード認証
   - JWTトークン発行
   - セッション管理

2. **ログアウト機能**
   - セッション無効化
   - トークン削除

3. **認証状態管理**
   - 認証状態チェック
   - 保護されたページへのアクセス制御

4. **画面実装**
   - ログインページ（SCR-001）
   - ダッシュボード（SCR-002）
   - 保護されたページ（SCR-003）
   - エラーページ（SCR-004）

## 2. 実装フロー（番号付き）

### フェーズ1: 基盤構築
1. **プロジェクト構造の作成**
   - Docker Compose設定
   - ディレクトリ構成
   - パッケージ管理ファイル（package.json）

2. **データベース設計とマイグレーション**
   - usersテーブル作成
   - sessionsテーブル作成
   - 初期データ投入（テストユーザー）

### フェーズ2: バックエンド実装
3. **バックエンドAPI基盤の構築**
   - Expressサーバー設定
   - ルーティング設定
   - ミドルウェア設定（CORS、JSONパーサー、エラーハンドリング）

4. **認証API実装（POST /api/auth/login）**
   - リクエストバリデーション
   - ユーザー認証処理
   - JWTトークン生成
   - レスポンス返却

5. **認証API実装（POST /api/auth/logout）**
   - セッション無効化
   - レスポンス返却

6. **認証状態確認API実装（GET /api/auth/me）**
   - トークン検証
   - ユーザー情報取得
   - レスポンス返却

### フェーズ3: フロントエンド実装
7. **フロントエンド基盤の構築**
   - Reactプロジェクト設定
   - ルーティング設定（React Router）
   - 認証コンテキスト（AuthContext）作成
   - 認証ガード（AuthGuard）実装

8. **ログインページ実装（SCR-001）**
   - UIコンポーネント作成
   - フォームバリデーション
   - API連携
   - エラーハンドリング

9. **ダッシュボード実装（SCR-002）**
   - UIコンポーネント作成
   - ログアウト機能実装
   - 保護されたページへのリンク

10. **保護されたページ実装（SCR-003）**
    - UIコンポーネント作成
    - 認証ガード適用

11. **エラーページ実装（SCR-004）**
    - UIコンポーネント作成
    - エラーハンドリング

### フェーズ4: 統合・テスト
12. **統合テストと動作確認**
    - エンドツーエンドテスト
    - 各シナリオの動作確認
    - バグ修正

## 3. 開発環境

### 3.1 環境
- **OS**: Windows（WSLでLinux入力を可能とする）
- **コンテナ**: 3つのコンテナ（フロントエンド、バックエンド、DB）

### 3.2 ポート設定
- **フロントエンド**: http://localhost:3003
- **バックエンドAPI**: http://localhost:3004
- **MySQL**: localhost:3306

## 4. 現在の実装ステップ

**現在のステップ: 1. プロジェクト構造の作成（完了）**

次のステップに進む前に、このステップの実装内容を確認・レビューしていただきます。

